webpackJsonp([2,0],{0:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=a(159),i=n(s),o=a(210),r=n(o);i.default.config.ignoredElements=["home","page-two"],a(199),a(206),new i.default({el:"#app",template:"<App/>",components:{App:r.default}})},160:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(211),i=n(s),o=a(212),r=n(o);e.default={name:"app",data:function(){return{app:phonon.navigator()}},mounted:function(){var t=this;this.$nextTick(function(){phonon.options({navigator:{defaultPage:"home",animatePages:!0,enableBrowserBackButton:!0},i18n:null}),window.setTimeout(function(){t.app.start()},500)})},components:{Home:i.default,PageTwo:r.default}}},161:function(t,e,a){(function(t){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(1),i=n(s),o=a(202),r=n(o),c=a(163),u=n(c);e.default={name:"PhononHomePage",props:{app:{type:Object}},mounted:function(){var t=this;this.app.on({page:"home",preventClose:!1,content:null}),this.get_his_data(),document.addEventListener("deviceready",function(){t.device_ready=!0},!1)},data:function(){return{device_ready:!1,oil_type:"92#",company:"中石化",density:"",price:"",carriage:"130",result:0,his_quote:[],begin_date:"",end_date:""}},computed:{is_empty:function(){return 0==r.default.size(this.his_quote)},date_num:function(){return r.default.uniqBy(this.his_quote,"date")},group_data:function(){function t(e){r.default.isPlainObject(e)&&(e.sorted_keys=r.default.chain(e).keys().sortBy().value(),r.default.each(e,function(e){return t(e)}))}var e=this,a=r.default.groupBy(this.his_quote,"date");return r.default.each(a,function(t,e){a[e]=r.default.groupBy(t,"oil_type"),r.default.each(a[e],function(t,n){a[e][n]=r.default.orderBy(t,[function(t){return parseFloat(t.result)}],["desc"])})}),t(a),this.begin_date&&(a.sorted_keys=r.default.filter(a.sorted_keys,function(t){return t>=e.begin_date})),this.end_date&&(a.sorted_keys=r.default.filter(a.sorted_keys,function(t){return t<=e.end_date})),r.default.reverse(a.sorted_keys),a}},methods:{process_import_data:function(e){var a=this;if(0!=e.target.files.length){var n=["txt","csv"],s=e.target.files[0],i=s.name.split(".").pop().toLowerCase(),o=n.indexOf(i)>-1;if(!o)return phonon.alert("只能导入txt文件","文件格式错误");var c=new FileReader;c.onload=function(t){var e=t.target.result;u.default.then(function(t){var n=e.split("\r\n");n.pop(),r.default.each(n,function(e){e=e.split(",");var a={date:e[0],oil_type:e[1],company:e[2],result:e[3]};t.his_quote.insert(a)}),a.get_his_data()})},c.onerror=function(t){phonon.alert("导入失败","导入数据")},c.readAsText(s),t('input[type="file"]').val("")}},import_csv:function(){t('input[type="file"]').click()},filter_by_date:function(){console.log("begin_date="+this.begin_date,"end_date="+this.end_date)},get_csv:function(){var t=r.default.reduce(this.his_quote,function(t,e){return e=r.default.pick(e,["date","oil_type","company","result"]),t+r.default.values(e).join(",")+"\r\n"},"");return t},exp_csv:function(){var t=(0,i.default)().format("YYYYMMDDHHmmssSSS");t+=".txt";var e=this.get_csv();window.resolveLocalFileSystemURL(cordova.file.externalDataDirectory,function(a){a.getFile(t,{create:!0,exclusive:!1},function(t){t.createWriter(function(a){a.onwriteend=function(){phonon.alert("已导出至："+t.toURL(),"导出成功（请备份）")},a.onerror=function(t){phonon.alert("操作失败","导出数据")};var n=new Blob([e],{type:"text/plain"});a.write(n)})},function(){return phonon.alert("创建文件失败","导出数据")})},function(){return phonon.alert("打开文件系统失败","导出数据")})},empty_input:function(){this.price=this.density="","中石化"==this.company?this.carriage=130:"中石油"==this.company?this.carriage=130:"中化"==this.company?this.carriage=220:this.carriage=""},get_his_data:function(){var t=this;u.default.then(function(e){t.his_quote=e.his_quote.find({}),0==t.his_quote.length})},clear:function(){var t=this,e=phonon.confirm("请在删除前导出数据文件，并备份至电脑","确认清除？",!0,"确认","取消");e.on("confirm",function(){u.default.then(function(e){e.his_quote.remove(e.his_quote.find({})),t.get_his_data()})})},calc:function(){var t=this;return this.price&&this.carriage&&this.density?(this.result=(this.price+this.carriage)/(1e3/this.density),this.result=parseFloat(this.result).toFixed(2),console.log(this.result),void u.default.then(function(e){var a=(0,i.default)().format("YYYY-MM-DD"),n={date:a,oil_type:t.oil_type,company:t.company},s=e.his_quote.findOne(n);s?(s.result=t.result,e.his_quote.update(s)):(n.result=t.result,e.his_quote.insert(n)),t.get_his_data()})):phonon.alert("价格 或 运费 或 密度， 不能为空！","请填写参数")}}}}).call(e,a(23))},162:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(159),i=n(s);i.default.directive("tap",{isFn:!0,bind:function(t,e){t.on("tap",e.value)}}),e.default={name:"PhononPageTwo",props:{app:{type:Object}},data:function(){return{pizza:"",action:null}},mounted:function(){this.app.on({page:"page-two",preventClose:!0},this)},methods:{onClose:function(t){null!==this.action?t.close():phonon.alert("Before leaving this page, you must perform an action.","Action required")},onHidden:function(){this.action=null},onHashChanged:function(t){this.pizza=t},onAction:function(t){this.action="user-action","order"===t.target.getAttribute("data-order")?phonon.alert("Thank you for your order!","Dear customer"):phonon.alert("Your order has been canceled.","Dear customer")}}}},163:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(164),i=n(s),o=a(203),r=n(o),c=a(40),u=n(c),l=new u.default,d=void 0;e.default=new i.default(function(t,e){if(d)t(d);else var a=new r.default("quote.db",{adapter:l,autoload:!0,autoloadCallback:function(){d={his_quote:a.getCollection("his_quote")?a.getCollection("his_quote"):a.addCollection("his_quote")},t(d)},autosave:!0,autosaveInterval:1e3})})},199:function(t,e){},200:function(t,e){},201:function(t,e){},204:function(t,e,a){function n(t){return a(s(t))}function s(t){return i[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var i={"./af":41,"./af.js":41,"./ar":48,"./ar-dz":42,"./ar-dz.js":42,"./ar-kw":43,"./ar-kw.js":43,"./ar-ly":44,"./ar-ly.js":44,"./ar-ma":45,"./ar-ma.js":45,"./ar-sa":46,"./ar-sa.js":46,"./ar-tn":47,"./ar-tn.js":47,"./ar.js":48,"./az":49,"./az.js":49,"./be":50,"./be.js":50,"./bg":51,"./bg.js":51,"./bm":52,"./bm.js":52,"./bn":53,"./bn.js":53,"./bo":54,"./bo.js":54,"./br":55,"./br.js":55,"./bs":56,"./bs.js":56,"./ca":57,"./ca.js":57,"./cs":58,"./cs.js":58,"./cv":59,"./cv.js":59,"./cy":60,"./cy.js":60,"./da":61,"./da.js":61,"./de":64,"./de-at":62,"./de-at.js":62,"./de-ch":63,"./de-ch.js":63,"./de.js":64,"./dv":65,"./dv.js":65,"./el":66,"./el.js":66,"./en-au":67,"./en-au.js":67,"./en-ca":68,"./en-ca.js":68,"./en-gb":69,"./en-gb.js":69,"./en-ie":70,"./en-ie.js":70,"./en-nz":71,"./en-nz.js":71,"./eo":72,"./eo.js":72,"./es":75,"./es-do":73,"./es-do.js":73,"./es-us":74,"./es-us.js":74,"./es.js":75,"./et":76,"./et.js":76,"./eu":77,"./eu.js":77,"./fa":78,"./fa.js":78,"./fi":79,"./fi.js":79,"./fo":80,"./fo.js":80,"./fr":83,"./fr-ca":81,"./fr-ca.js":81,"./fr-ch":82,"./fr-ch.js":82,"./fr.js":83,"./fy":84,"./fy.js":84,"./gd":85,"./gd.js":85,"./gl":86,"./gl.js":86,"./gom-latn":87,"./gom-latn.js":87,"./gu":88,"./gu.js":88,"./he":89,"./he.js":89,"./hi":90,"./hi.js":90,"./hr":91,"./hr.js":91,"./hu":92,"./hu.js":92,"./hy-am":93,"./hy-am.js":93,"./id":94,"./id.js":94,"./is":95,"./is.js":95,"./it":96,"./it.js":96,"./ja":97,"./ja.js":97,"./jv":98,"./jv.js":98,"./ka":99,"./ka.js":99,"./kk":100,"./kk.js":100,"./km":101,"./km.js":101,"./kn":102,"./kn.js":102,"./ko":103,"./ko.js":103,"./ky":104,"./ky.js":104,"./lb":105,"./lb.js":105,"./lo":106,"./lo.js":106,"./lt":107,"./lt.js":107,"./lv":108,"./lv.js":108,"./me":109,"./me.js":109,"./mi":110,"./mi.js":110,"./mk":111,"./mk.js":111,"./ml":112,"./ml.js":112,"./mr":113,"./mr.js":113,"./ms":115,"./ms-my":114,"./ms-my.js":114,"./ms.js":115,"./my":116,"./my.js":116,"./nb":117,"./nb.js":117,"./ne":118,"./ne.js":118,"./nl":120,"./nl-be":119,"./nl-be.js":119,"./nl.js":120,"./nn":121,"./nn.js":121,"./pa-in":122,"./pa-in.js":122,"./pl":123,"./pl.js":123,"./pt":125,"./pt-br":124,"./pt-br.js":124,"./pt.js":125,"./ro":126,"./ro.js":126,"./ru":127,"./ru.js":127,"./sd":128,"./sd.js":128,"./se":129,"./se.js":129,"./si":130,"./si.js":130,"./sk":131,"./sk.js":131,"./sl":132,"./sl.js":132,"./sq":133,"./sq.js":133,"./sr":135,"./sr-cyrl":134,"./sr-cyrl.js":134,"./sr.js":135,"./ss":136,"./ss.js":136,"./sv":137,"./sv.js":137,"./sw":138,"./sw.js":138,"./ta":139,"./ta.js":139,"./te":140,"./te.js":140,"./tet":141,"./tet.js":141,"./th":142,"./th.js":142,"./tl-ph":143,"./tl-ph.js":143,"./tlh":144,"./tlh.js":144,"./tr":145,"./tr.js":145,"./tzl":146,"./tzl.js":146,"./tzm":148,"./tzm-latn":147,"./tzm-latn.js":147,"./tzm.js":148,"./uk":149,"./uk.js":149,"./ur":150,"./ur.js":150,"./uz":152,"./uz-latn":151,"./uz-latn.js":151,"./uz.js":152,"./vi":153,"./vi.js":153,"./x-pseudo":154,"./x-pseudo.js":154,"./yo":155,"./yo.js":155,"./zh-cn":156,"./zh-cn.js":156,"./zh-hk":157,"./zh-hk.js":157,"./zh-tw":158,"./zh-tw.js":158};n.keys=function(){return Object.keys(i)},n.resolve=s,t.exports=n,n.id=204},210:function(t,e,a){a(200);var n=a(24)(a(160),a(214),null,null);t.exports=n.exports},211:function(t,e,a){a(201);var n=a(24)(a(161),a(215),"data-v-832d564e",null);t.exports=n.exports},212:function(t,e,a){var n=a(24)(a(162),a(213),null,null);t.exports=n.exports},213:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-two",{attrs:{"data-page":"true"}},[a("header",{staticClass:"header-bar"},[a("div",{staticClass:"left"},[a("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}}),t._v(" "),a("h1",{staticClass:"title"},[t._v("Page Two")])])]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"padded-full"},[a("h2",[t._v("Order")]),t._v(" "),a("p",[t._v("1x Pizza: "+t._s(t.pizza))]),t._v(" "),a("button",{directives:[{name:"tap",rawName:"v-tap",value:t.onAction,expression:"onAction"}],staticClass:"btn negative cancel",attrs:{"data-order":"cancel"}},[t._v("Cancel")]),t._v(" "),a("button",{directives:[{name:"tap",rawName:"v-tap",value:t.onAction,expression:"onAction"}],staticClass:"btn btn-flat primary order",attrs:{"data-order":"order"}},[t._v("Order")])])])])},staticRenderFns:[]}},214:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("home",{attrs:{app:t.app}}),t._v(" "),a("page-two",{attrs:{app:t.app}})],1)},staticRenderFns:[]}},215:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("home",{attrs:{"data-page":"true"}},[a("header",{staticClass:"header-bar"},[a("div",{staticClass:"center"},[a("h1",{staticClass:"title"},[t._v("油价计算/比较工具")])])]),t._v(" "),a("div",{staticClass:"content"},[a("i",{staticClass:"sel_item"},[a("div",{staticClass:"raido_group"},[a("div",[a("label",{staticClass:"radio"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.oil_type,expression:"oil_type"}],attrs:{type:"radio",name:"type",value:"0#"},domProps:{checked:t._q(t.oil_type,"0#")},on:{change:[function(e){t.oil_type="0#"},function(e){t.empty_input()}]}}),t._v(" "),a("span"),t._v(" "),a("span",{staticClass:"text"},[t._v("0#")])])]),t._v(" "),a("div",[a("label",{staticClass:"radio"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.oil_type,expression:"oil_type"}],attrs:{type:"radio",name:"type",value:"92#"},domProps:{checked:t._q(t.oil_type,"92#")},on:{change:[function(e){t.oil_type="92#"},function(e){t.empty_input()}]}}),t._v(" "),a("span"),t._v(" "),a("span",{staticClass:"text"},[t._v("92#")])])]),t._v(" "),a("div",[a("label",{staticClass:"radio"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.oil_type,expression:"oil_type"}],attrs:{type:"radio",name:"type",value:"95#"},domProps:{checked:t._q(t.oil_type,"95#")},on:{change:[function(e){t.oil_type="95#"},function(e){t.empty_input()}]}}),t._v(" "),a("span"),t._v(" "),a("span",{staticClass:"text"},[t._v("95#")])])])]),t._v(" "),a("div",{staticClass:"raido_group",staticStyle:{flex:"1"}},[a("div",[a("label",{staticClass:"radio"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.company,expression:"company"}],attrs:{type:"radio",name:"company",value:"中石化"},domProps:{checked:t._q(t.company,"中石化")},on:{change:[function(e){t.company="中石化"},function(e){t.empty_input()}]}}),t._v(" "),a("span"),t._v(" "),a("span",{staticClass:"text"},[t._v("中石化")])])]),t._v(" "),a("div",[a("label",{staticClass:"radio"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.company,expression:"company"}],attrs:{type:"radio",name:"company",value:"中石油"},domProps:{checked:t._q(t.company,"中石油")},on:{change:[function(e){t.company="中石油"},function(e){t.empty_input()}]}}),t._v(" "),a("span"),t._v(" "),a("span",{staticClass:"text"},[t._v("中石油")])])]),t._v(" "),a("div",[a("label",{staticClass:"radio"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.company,expression:"company"}],attrs:{type:"radio",name:"company",value:"中化"},domProps:{checked:t._q(t.company,"中化")},on:{change:[function(e){t.company="中化"},function(e){t.empty_input()}]}}),t._v(" "),a("span"),t._v(" "),a("span",{staticClass:"text"},[t._v("中化")])])]),t._v(" "),a("div",[a("label",{staticClass:"radio"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.company,expression:"company"}],attrs:{type:"radio",name:"company",value:"其他"},domProps:{checked:t._q(t.company,"其他")},on:{change:[function(e){t.company="其他"},function(e){t.empty_input()}]}}),t._v(" "),a("span"),t._v(" "),a("span",{staticClass:"text"},[t._v("其他")])])])])]),t._v(" "),a("div",{staticClass:"parameters"},[a("div",[a("div",{staticClass:"caption"},[t._v("价格：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.price,expression:"price",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"价格"},domProps:{value:t.price},on:{input:function(e){e.target.composing||(t.price=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),a("div",[a("div",{staticClass:"caption"},[t._v("运费：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.carriage,expression:"carriage",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"运费"},domProps:{value:t.carriage},on:{input:function(e){e.target.composing||(t.carriage=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),a("div",[a("div",{staticClass:"caption"},[t._v("密度：")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.density,expression:"density",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"密度"},domProps:{value:t.density},on:{input:function(e){e.target.composing||(t.density=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),a("button",{staticClass:"btn primary",on:{click:function(e){e.preventDefault(),t.calc()}}},[t._v("计算")])]),t._v(" "),a("div",{staticStyle:{"justify-content":"space-around","margin-top":"10px"}},[t.is_empty?t._e():a("button",{staticClass:"btn negative",staticStyle:{flex:"1"},on:{click:function(e){e.preventDefault(),t.clear()}}},[t._v("清除历史数据")]),t._v(" "),!t.is_empty&&t.device_ready?a("button",{staticClass:"btn positive",staticStyle:{flex:"1"},on:{click:function(e){e.preventDefault(),t.exp_csv()}}},[t._v("导出数据")]):t._e(),t._v(" "),a("input",{attrs:{type:"file"},on:{change:function(e){t.process_import_data(e)}}}),t._v(" "),a("button",{staticClass:"btn primary",staticStyle:{flex:"1"},on:{click:function(e){e.preventDefault(),t.import_csv()}}},[t._v("导入")])]),t._v(" "),t.date_num.length>5?a("div",{staticStyle:{"justify-content":"space-around"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.begin_date,expression:"begin_date"}],staticStyle:{flex:"1"},attrs:{type:"date",placeholder:"起始日期"},domProps:{value:t.begin_date},on:{change:function(e){t.filter_by_date()},input:function(e){e.target.composing||(t.begin_date=e.target.value)}}}),t._v(" "),a("div",{staticClass:"caption"},[t._v("——")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.end_date,expression:"end_date"}],staticStyle:{flex:"1"},attrs:{type:"date",placeholder:"截止日期"},domProps:{value:t.end_date},on:{change:function(e){t.filter_by_date()},input:function(e){e.target.composing||(t.end_date=e.target.value)}}})]):t._e(),t._v(" "),a("span",{staticClass:"his-data"},t._l(t.group_data.sorted_keys,function(e){return a("div",{staticClass:"date"},[a("div",{staticStyle:{"font-size":"32px"}},[t._v(t._s(e))]),t._v(" "),t._l(t.group_data[e].sorted_keys,function(n){return a("div",{staticClass:"oil_type"},[a("div",{staticStyle:{"font-size":"26px"}},[t._v(t._s(n))]),t._v(" "),a("div",{staticClass:"rank"},t._l(t.group_data[e][n],function(s,i){return a("div",[t._v("\n              "+t._s(s.company+"("+s.result+")")+"\n              "),i!=t.group_data[e][n].length-1?a("span",[t._v(" \n                 "+t._s(t.group_data[e][n][i+1]&&s.result==t.group_data[e][n][i+1].result?"=":">")+"  \n              ")]):t._e()])}))])})],2)}))])])},staticRenderFns:[]}}});
//# sourceMappingURL=app.a881669e99535c5599ab.js.map